# 블로그 댓글 시스템 요구사항

## 1. 개요
블로그의 댓글 섹션에 Firebase를 활용한 댓글 시스템을 구현하여 블로그 관리자와 방문자들이 서로 소통할 수 있는 기능을 구현합니다.

## 2. 기본 요구사항

### 2.1 댓글 구성 요소
- **이름**: 댓글 작성자 이름 (필수 입력)
- **이메일**: 댓글 작성자 이메일 (선택 입력, 답글 알림 용도)
- **날짜-시간**: 댓글 작성 시간 자동 기록 (YYYY-MM-DD HH:MM 형식, 초 단위는 저장하지 않음)
- **댓글 내용**: 최대 200자 제한
- **고유 ID**: 각 댓글에 고유 식별자 부여
- **부모 ID**: 대댓글인 경우 부모 댓글의 ID (최상위 댓글은 null)
- **깊이(depth)**: 댓글의 계층 깊이 (최상위 댓글은 0, 대댓글은 1 이상)

### 2.2 입력 형식
- 텍스트 입력 지원
- 이모티콘(이모지) 입력 지원
- 마크다운 형식 지원 (선택적)
- 폼 유효성 검증:
  - 이름과 내용은 필수 필드로 설정
  - 이름과 내용 입력 시만 제출 버튼 활성화
  - 이메일은 선택 입력 필드
  - 이메일 입력 시 유효한 이메일 형식 검증

### 2.3 미디어 지원
- 이미지 URL 입력 시 해당 이미지 표시 (jpg, png, webp 등)
- GIF URL 입력 시 애니메이션 표시
- 미디어 미리보기 제공
- 이미지 크기 자동 최적화 (반응형)

### 2.4 댓글 표시
- 최신순 정렬 상태로 댓글 표시 (내림차순)
- 페이지네이션 구현 (한 페이지당 10개 최상위 댓글 표시)
- 댓글 수가 많을 경우 'Load More' 버튼 제공

### 2.5 중첩 댓글 (대댓글)
- 최대 10단계 깊이까지 대댓글 지원
- 각 대댓글 수준별 시각적 구분:
  - 들여쓰기로 계층 표현 (모바일에서는 제한된 들여쓰기)
  - 왼쪽 세로선으로 계층 구분 (각 깊이별 다른 색상 또는 음영 처리)
  - 폰트 크기 미세 조정 (깊이가 깊을수록 약간 작게, 최대 3단계까지)
- **대댓글 탐색**:
  - 특정 댓글에 달린 모든 대댓글 한번에 접기/펼치기 기능
  - 대댓글이 많을 경우 '더보기' 버튼으로 일부만 표시
  - 대댓글 깊이가 5 이상인 경우 '더 보기' 버튼으로 접어두기
- **대댓글 작성**:
  - 각 댓글마다 '답글' 버튼 제공
  - 대댓글 작성 시 원본 댓글 작성자 이름 자동 언급 (@이름)

## 3. 기술 요구사항

### 3.1 Firebase 연동
- Firebase Realtime Database 또는 Firestore 활용
- **댓글 데이터 구조 최적화**:
  - 계층형 구조와 쿼리 효율성 균형 고려
  - 최상위 댓글과 대댓글을 별도 컬렉션으로 분리 또는 단일 컬렉션에 parent_id 필드 활용
  - 댓글 정렬을 위한 인덱스 필드 추가 (created_at, likes_count 등)
  - 댓글 깊이(depth) 필드로 중첩 레벨 관리
- 실시간 업데이트 구현 (새 댓글 작성 시 즉시 반영)
- 대댓글 로딩 최적화 (필요시에만 로드)

### 3.2 보안 및 인증
- 스팸 방지 대책 (CAPTCHA 또는 유사 메커니즘)
- 간단한 익명 인증 지원 (이름만 입력)
- 댓글 수정/삭제 기능 (작성자만)

### 3.3 성능 최적화
- 댓글 로딩 지연 최소화
- 페이지 로드 시 초기 댓글만 로드
- 스크롤 시 추가 댓글 로드 (Lazy Loading)
- 이미지 지연 로딩 구현

### 3.4 접근성 및 반응형 디자인
- 모든 기기에서 사용 가능한 반응형 UI
- 다크 모드/라이트 모드 지원(전체 홈페이지에서 선택시)
- 접근성 표준 준수 (WCAG 2.1)
- 키보드 탐색 지원

## 4. UI/UX 요구사항

### 4.1 입력 폼 디자인
- 사용자 친화적인 댓글 입력 폼
- 남은 글자 수 표시
- 미디어 URL 입력 시 미리보기 제공
- 확인버튼

### 4.2 댓글 표시 디자인
- 각 댓글 카드 형태로 표시
- 작성자 이름 강조
- 타임스태프 표시 (상대적: '5분 전', '어제' 등)
- 중첩 댓글 시각적 구분
- 좋아요/싫어요 버튼 (선택적)

### 4.3 댓글 수정/삭제
- 댓글 수정/삭제 버튼 및 기능 (작성자만)

## 5. 관리 기능

### 5.1 관리자 기능
- 모든 댓글 관리 패널
- 부적절한 댓글 숨김/삭제 기능
- 특정 사용자(ip address, 이름) 차단 기능
- 댓글 통계 (수, 빈도 등)
- **이메일 알림 기능**:
  - 새로운 댓글 작성 시 운영자 이메일(fromsnowman14@gmail.com)로 알림 전송
  - 답글이 달린 댓글 작성자가 이메일을 입력한 경우, 해당 이메일로 알림 전송
  - 알림 내용에는 댓글 작성자, 내용, 작성 시간, 해당 페이지 URL 포함
  - 대댓글인 경우 원본 댓글 정보도 함께 포함

### 5.2 모더레이션
- 금지어 필터링
- 스팸 댓글 자동 감지
- 사용자 신고 기능
- 신고된 댓글 검토 시스템

## 6. 테스트 요구사항
- 다양한 브라우저 호환성 테스트
- 모바일 기기 테스트
- 대량 댓글 처리 성능 테스트
- 오프라인 동작 테스트

## 7. 구현 계획
1. Firebase 프로젝트 설정
2. 데이터 모델 설계
3. 기본 댓글 입력/표시 구현
4. 중첩 댓글 기능 구현
5. 이미지/GIF 지원 추가
6. 관리자 이메일 알림 기능 구현
7. UI/UX 개선
8. 성능 최적화
9. 테스트 및 디버깅